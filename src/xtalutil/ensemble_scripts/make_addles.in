#!/usr/bin/perl

#-----------------------------------------------------------------------
#  find the alternates and create addles.in commands
#     stdin can be piped in from 'find_alts <pdb-file>'
#-----------------------------------------------------------------------

$id = $ARGV[0];

# print header:
print <<EOF;
file rprm name=($id.parm7) read
file rcbd name=($id.rst7) read
file wprm name=($id.LES.parm7) wovr
file wcrd name=($id.LES.rst7) wovr
action
omas
EOF

<STDIN>;  # skip the blank first line

while (<STDIN>){

   @f = split(' ', $_);
   $resno = $f[0];
   $firstat = $f[1];
   $alts = @f - 2;

   next if $alts == 1;  # can't handle partially occupied single conformers

   if( $firstat eq "CA" ){
      print "spac numc=$alts pick #nbb $resno $resno done\n";
   elsif( $firstat eq "CB" ){
      print "spac numc=$alts pick #sid $resno $resno done\n";
   elsif( $firstat eq "CG" ){
      print "spac numc=$alts pick #sig $resno $resno done\n";
   } elsif ( $firstat eq "N" ){
      print "spac numc=$alts pick #mon $resno $resno done\n";
   }

}

#print trailer:
print "*EOD\n";

